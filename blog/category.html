---
layout: default
title: Category Search
---

<div id="post-preview-container"></div>
<script type="text/javascript">
  
  $(document).ready(function(){

    var template = '<div class="post-preview"><h2 class="post-preview-title"><a href="{url}">{title}</a></h2></div>';
    var searchTerm = getUrlVars()[0];

    fetch("https://www.minewyrtruman.com/mwtest/search.json", {
            mode: "same-origin", // no-cors, *cors, same-origin
            cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
            credentials: "same-origin"
        }).then(results => {
            return results.json();
        }).then(function(posts) {
            var postPreviews = new Array();
            posts.forEach(post => {
                if(post.category !== undefined) {
                    if(post.category.includes(searchTerm)) {
                        var postPreview = $('<div class="post-preview">');
                        var postMetadata = $('<span>').html("Posted by " + post.author + "on " + post.date + "in");
                        var categories = post.category.split(",");
                        categories.forEach(c => {
                            postMetadata.append("&nbsp;");
                            postMetadata.append($('<a>').html(c).attr("href", "?" + c));
                        });
                        
                        postPreview.append($("<h2>").append($('<a>').html(post.title).attr("href", post.url)));
                        postPreview.append(postMetadata);
                        postPreview.append($('<p>').html(post.excerpt));
                        postPreviews.push(postPreview);
                    }
                }
            });

            $('#post-preview-container').append(postPreviews);
        });
  });
  
    function getUrlVars()
    {
        var vars = [], hash;
        var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
        for(var i = 0; i < hashes.length; i++)
        {
            hash = hashes[i].split('=');
            vars.push(hash[0]);
            vars[hash[0]] = hash[1];
        }
        return vars;
    }
</script>